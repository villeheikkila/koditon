version: "2"
sql:
  - engine: postgresql
    database:
      uri: "postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}?sslmode=disable"
    schema:
      - internal/prices/db/schema.sql
    queries:
      - internal/prices/db/queries.sql
    gen:
      go:
        out: internal/prices/db
        package: db
        sql_package: "pgx/v5"
        emit_json_tags: true
        emit_db_tags: true
        emit_empty_slices: true
        emit_params_struct_pointers: true
        query_parameter_limit: 1
        overrides:
          - db_type: "jsonb"
            go_type:
              type: "json.RawMessage"
          - db_type: "pg_catalog.text"
            nullable: false
            go_type:
              type: "string"
          - db_type: "pg_catalog.text"
            nullable: true
            go_type:
              type: "string"
              pointer: true
          - db_type: "text"
            nullable: false
            go_type:
              type: "string"
          - db_type: "text"
            nullable: true
            go_type:
              type: "string"
              pointer: true
          - db_type: "pg_catalog.bool"
            nullable: false
            go_type:
              type: "bool"
          - db_type: "pg_catalog.bool"
            nullable: true
            go_type:
              type: "bool"
              pointer: true
          - db_type: "bool"
            nullable: false
            go_type:
              type: "bool"
          - db_type: "bool"
            nullable: true
            go_type:
              type: "bool"
              pointer: true
          - db_type: "pg_catalog.int8"
            nullable: false
            go_type:
              type: "int64"
          - db_type: "pg_catalog.int8"
            nullable: true
            go_type:
              type: "int64"
              pointer: true
          - db_type: "pg_catalog.int4"
            nullable: true
            go_type:
              type: "int32"
              pointer: true
          - db_type: "pg_catalog.int4"
            nullable: false
            go_type:
              type: "int32"
          - db_type: "int4"
            nullable: true
            go_type:
              type: "int32"
              pointer: true
          - db_type: "int4"
            nullable: false
            go_type:
              type: "int32"
          - db_type: "pg_catalog.float8"
            nullable: false
            go_type:
              type: "float64"
          - db_type: "pg_catalog.float8"
            nullable: true
            go_type:
              type: "float64"
              pointer: true
          - db_type: "float8"
            nullable: false
            go_type:
              type: "float64"
          - db_type: "float8"
            nullable: true
            go_type:
              type: "float64"
              pointer: true
          - db_type: "pg_catalog.timestamptz"
            go_type:
              type: "time.Time"
          - db_type: "pg_catalog.date"
            nullable: true
            go_type:
              type: "time.Time"
              pointer: true
          - db_type: "date"
            nullable: true
            go_type:
              type: "time.Time"
              pointer: true

  - engine: postgresql
    database:
      uri: "postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}?sslmode=disable"
    schema:
      - internal/taskqueue/db/schema.sql
    queries:
      - internal/taskqueue/db/queries.sql
    gen:
      go:
        out: internal/taskqueue/db
        package: db
        sql_package: "pgx/v5"
        emit_json_tags: true
        emit_db_tags: true
        emit_empty_slices: true
        query_parameter_limit: 50
        overrides:
          - db_type: "jsonb"
            go_type:
              type: "json.RawMessage"
          - db_type: "pg_catalog.text"
            go_type:
              type: "string"
          - db_type: "pg_catalog.bool"
            go_type:
              type: "bool"
          - db_type: "pg_catalog.int8"
            go_type:
              type: "int64"
          - db_type: "pg_catalog.int4"
            nullable: true
            go_type:
              type: "int64"
              pointer: true
          - db_type: "pg_catalog.int4"
            nullable: false
            go_type:
              type: "int64"
          - db_type: "pg_catalog.timestamptz"
            go_type:
              type: "time.Time"

  - engine: postgresql
    database:
      uri: "postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}?sslmode=disable"
    schema: []
    queries:
      - internal/pgmq/db/queries.sql
    gen:
      go:
        out: internal/pgmq/db
        package: db
        sql_package: "pgx/v5"
        emit_json_tags: true
        emit_db_tags: true
        emit_empty_slices: true
        query_parameter_limit: 50
        overrides:
          # Text - explicit cast to text in queries
          - db_type: "text"
            go_type:
              type: "string"
          - db_type: "pg_catalog.text"
            go_type:
              type: "string"
          # Boolean - explicit cast to bool in queries
          - db_type: "bool"
            go_type:
              type: "bool"
          - db_type: "pg_catalog.bool"
            go_type:
              type: "bool"
          # Bigint - explicit cast to bigint in queries
          - db_type: "bigint"
            go_type:
              type: "int64"
          - db_type: "int8"
            go_type:
              type: "int64"
          - db_type: "pg_catalog.int8"
            go_type:
              type: "int64"
          # Integer - explicit cast to int in queries
          - db_type: "int4"
            nullable: true
            go_type:
              type: "int32"
              pointer: true
          - db_type: "int4"
            nullable: false
            go_type:
              type: "int32"
          - db_type: "integer"
            nullable: true
            go_type:
              type: "int32"
              pointer: true
          - db_type: "integer"
            nullable: false
            go_type:
              type: "int32"
          - db_type: "pg_catalog.int4"
            nullable: true
            go_type:
              type: "int32"
              pointer: true
          - db_type: "pg_catalog.int4"
            nullable: false
            go_type:
              type: "int32"
          # Timestamptz - explicit cast to timestamptz in queries
          - db_type: "timestamptz"
            go_type:
              type: "time.Time"
          - db_type: "pg_catalog.timestamptz"
            go_type:
              type: "time.Time"
          - db_type: "timestamp with time zone"
            go_type:
              type: "time.Time"
          # JSONB - explicit cast to jsonb in queries
          - db_type: "jsonb"
            go_type:
              type: "json.RawMessage"
          - db_type: "jsonb"
            nullable: true
            go_type:
              type: "json.RawMessage"

  - engine: postgresql
    database:
      uri: "postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}?sslmode=disable"
    schema:
      - internal/frontdoor/db/schema.sql
    queries:
      - internal/frontdoor/db/queries.sql
    gen:
      go:
        out: internal/frontdoor/db
        package: db
        sql_package: "pgx/v5"
        emit_json_tags: true
        emit_db_tags: true
        emit_empty_slices: true
        emit_params_struct_pointers: true
        query_parameter_limit: 1
        overrides:
          - db_type: "jsonb"
            go_type:
              type: "json.RawMessage"
          - db_type: "pg_catalog.text"
            nullable: false
            go_type:
              type: "string"
          - db_type: "pg_catalog.text"
            nullable: true
            go_type:
              type: "string"
              pointer: true
          - db_type: "text"
            nullable: false
            go_type:
              type: "string"
          - db_type: "text"
            nullable: true
            go_type:
              type: "string"
              pointer: true
          - db_type: "pg_catalog.bool"
            nullable: false
            go_type:
              type: "bool"
          - db_type: "pg_catalog.bool"
            nullable: true
            go_type:
              type: "bool"
              pointer: true
          - db_type: "bool"
            nullable: false
            go_type:
              type: "bool"
          - db_type: "bool"
            nullable: true
            go_type:
              type: "bool"
              pointer: true
          - db_type: "pg_catalog.int8"
            nullable: false
            go_type:
              type: "int64"
          - db_type: "pg_catalog.int8"
            nullable: true
            go_type:
              type: "int64"
              pointer: true
          - db_type: "pg_catalog.int4"
            nullable: true
            go_type:
              type: "int32"
              pointer: true
          - db_type: "pg_catalog.int4"
            nullable: false
            go_type:
              type: "int32"
          - db_type: "int4"
            nullable: true
            go_type:
              type: "int32"
              pointer: true
          - db_type: "int4"
            nullable: false
            go_type:
              type: "int32"
          - db_type: "pg_catalog.float8"
            nullable: false
            go_type:
              type: "float64"
          - db_type: "pg_catalog.float8"
            nullable: true
            go_type:
              type: "float64"
              pointer: true
          - db_type: "float8"
            nullable: false
            go_type:
              type: "float64"
          - db_type: "float8"
            nullable: true
            go_type:
              type: "float64"
              pointer: true
          - db_type: "pg_catalog.timestamptz"
            go_type:
              type: "time.Time"
          - db_type: "pg_catalog.date"
            nullable: true
            go_type:
              type: "time.Time"
              pointer: true
          - db_type: "date"
            nullable: true
            go_type:
              type: "time.Time"
              pointer: true

  - engine: postgresql
    database:
      uri: "postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}?sslmode=disable"
    schema:
      - internal/shortcut/db/schema.sql
    queries:
      - internal/shortcut/db/queries.sql
    gen:
      go:
        out: internal/shortcut/db
        package: db
        sql_package: "pgx/v5"
        emit_json_tags: true
        emit_db_tags: true
        emit_empty_slices: true
        emit_params_struct_pointers: true
        query_parameter_limit: 1
        overrides:
          - db_type: "jsonb"
            go_type:
              type: "json.RawMessage"
          - db_type: "pg_catalog.text"
            nullable: false
            go_type:
              type: "string"
          - db_type: "pg_catalog.text"
            nullable: true
            go_type:
              type: "string"
              pointer: true
          - db_type: "text"
            nullable: false
            go_type:
              type: "string"
          - db_type: "text"
            nullable: true
            go_type:
              type: "string"
              pointer: true
          - db_type: "pg_catalog.bool"
            nullable: false
            go_type:
              type: "bool"
          - db_type: "pg_catalog.bool"
            nullable: true
            go_type:
              type: "bool"
              pointer: true
          - db_type: "bool"
            nullable: false
            go_type:
              type: "bool"
          - db_type: "bool"
            nullable: true
            go_type:
              type: "bool"
              pointer: true
          - db_type: "pg_catalog.int8"
            nullable: false
            go_type:
              type: "int64"
          - db_type: "pg_catalog.int8"
            nullable: true
            go_type:
              type: "int64"
              pointer: true
          - db_type: "pg_catalog.int4"
            nullable: true
            go_type:
              type: "int32"
              pointer: true
          - db_type: "pg_catalog.int4"
            nullable: false
            go_type:
              type: "int32"
          - db_type: "int4"
            nullable: true
            go_type:
              type: "int32"
              pointer: true
          - db_type: "int4"
            nullable: false
            go_type:
              type: "int32"
          - db_type: "pg_catalog.float8"
            nullable: false
            go_type:
              type: "float64"
          - db_type: "pg_catalog.float8"
            nullable: true
            go_type:
              type: "float64"
              pointer: true
          - db_type: "float8"
            nullable: false
            go_type:
              type: "float64"
          - db_type: "float8"
            nullable: true
            go_type:
              type: "float64"
              pointer: true
          - db_type: "pg_catalog.timestamptz"
            go_type:
              type: "time.Time"
